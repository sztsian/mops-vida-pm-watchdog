{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/service/index.ts","webpack:///./src/service/commands.ts","webpack:///./src/service/constants.ts","webpack:///./src/service/packets.ts","webpack:///./src/components/SensorConsole/index.scss","webpack:///./src/components/SensorConsole/FormattedPM25.scss","webpack:///./src/actions/sensor.ts","webpack:///./src/reducers/sensor.ts","webpack:///./src/reducers/report.ts","webpack:///./src/configureStore.ts","webpack:///./src/components/SensorConsole/FormattedPM25.tsx","webpack:///./src/components/SensorConsole/History.tsx","webpack:///./src/components/SensorConsole/MeasurementInterval.tsx","webpack:///./src/components/SensorConsole/index.tsx","webpack:///./src/Entry.tsx","webpack:///./src/reducers/index.ts","webpack:///./src/index.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","SensorService","device","this","events","handleValueChanged","event","target","emitBlock","Buffer","from","buffer","addEventListener","emit","navigator","bluetooth","requestDevice","filters","services","optionalServices","_a","server","gatt","connect","undefined","service","getPrimaryService","characteristic","getCharacteristic","startNotifications","_b","stopNotifications","disconnect","_c","removeAllListeners","block","writeValue","listener","on","off","packet","shutdown","makePacket","setMeasurementInterval","interval","of","setTime","now","Date","values","alloc","writeUInt32BE","Math","trunc","getTime","readHistory","nextHistory","setMeasurementEnable","enabled","type","header","payload","concat","checksum","reduce","prev","curr","RX_SERVICE_UUID","RX_CHAR_UUID","TX_CHAR_UUID","ShutdownPacket","assert","NoMoreHistoryPacket","HistoryPacket","pm25","readUInt16BE","recordDate","readUInt32BE","BatteryPacket","capacity","readUInt8","isCharging","freeze","seal","RuntimePacket","runtime","boottime","SensorPacket","currentDate","MeasurementSetupPacket","VersionPacket","minor","major","Error","mapping","aa01","aa0a","aa0b","aa5004","aa5005","aa5006","aa5007","aa5400","readPacket","toString","createAsync","setConnected","updatePacket","async","params","dispatch","getState","sensor","sendCommand","console","log","toUpperCase","sendMessage","case","done","state","connected","shuttingdown","latest","history","historyFully","draft","batteryCapacity","batteryCharging","measurementInterval","measurementIntervalEnabled","runTime","bootTime","version","join","sortedUniqBy","record","composeEnhancers","createElement","level","getLevel","className","replace","Level","Excellent","Good","LightlyPolluted","ModeratelyPolluted","HeavilyPolluted","SeverelyPolluted","History","report","Row","hidden","Button","size","color","onClick","encoded","JSON","stringify","link","document","href","URL","createObjectURL","Blob","download","fields","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","map","padStart","makeDownloadFile","click","Table","responsive","borderless","index","toLocaleString","steps","MeasurementInterval","useRef","open","setOpen","useState","onToggle","onChange","Fragment","Modal","placement","isOpen","toggle","ModalHeader","ModalBody","ListGroup","step","ListGroupItem","active","ModalFooter","_d","Container","container","ButtonGroup","disabled","table","field","Progress","store","router","Entry","exact","path","component","body","appendChild","render"],"mappings":"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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([75,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { EventEmitter } from 'events';\nimport { RX_SERVICE_UUID, RX_CHAR_UUID, TX_CHAR_UUID } from './constants';\nimport { readPacket } from './packets';\nimport * as Commands_1 from './commands';\nexport { Commands_1 as Commands };\nexport * from './packets';\nconst DISCONNECTED = 'gattserverdisconnected';\nconst VALUE_CHANGED = 'characteristicvaluechanged';\nexport class SensorService {\n    constructor(device) {\n        this.events = new EventEmitter();\n        this.handleValueChanged = (event) => {\n            const target = event.target;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.emitBlock(Buffer.from(target.value.buffer));\n        };\n        this.device = device;\n        device.addEventListener(DISCONNECTED, () => {\n            this.events.emit(\"disconnected\" /* disconnected */);\n        });\n    }\n    static async requestDevice() {\n        const device = await navigator.bluetooth.requestDevice({\n            filters: [{ services: [0x7676] }],\n            optionalServices: [RX_SERVICE_UUID],\n        });\n        return new SensorService(device);\n    }\n    async connect() {\n        var _a;\n        this.server = await ((_a = this.device.gatt) === null || _a === void 0 ? void 0 : _a.connect());\n        if (this.server === undefined) {\n            return;\n        }\n        const service = await this.server.getPrimaryService(RX_SERVICE_UUID);\n        const characteristic = await service.getCharacteristic(TX_CHAR_UUID);\n        characteristic.addEventListener(VALUE_CHANGED, this.handleValueChanged);\n        await characteristic.startNotifications();\n    }\n    async disconnect() {\n        var _a, _b;\n        try {\n            await ((_a = this.characteristic) === null || _a === void 0 ? void 0 : _a.stopNotifications());\n            (_b = this.device.gatt) === null || _b === void 0 ? void 0 : _b.disconnect();\n        }\n        catch (_c) {\n            // ignore\n        }\n        this.events.emit(\"disconnected\" /* disconnected */);\n        this.events.removeAllListeners();\n    }\n    async sendCommand(block) {\n        var _a;\n        const service = await ((_a = this.server) === null || _a === void 0 ? void 0 : _a.getPrimaryService(RX_SERVICE_UUID));\n        if (service === undefined) {\n            return;\n        }\n        const characteristic = await service.getCharacteristic(RX_CHAR_UUID);\n        await characteristic.writeValue(block);\n    }\n    on(event, listener) {\n        this.events.on(event, listener);\n        return () => {\n            this.events.off(event, listener);\n        };\n    }\n    emitBlock(block) {\n        try {\n            const packet = readPacket(block);\n            if (packet === undefined) {\n                this.events.emit(\"failed\" /* failed */, block);\n            }\n            else {\n                this.events.emit(\"packet\" /* packet */, packet);\n            }\n        }\n        catch (_a) {\n            this.events.emit(\"failed\" /* failed */, block);\n        }\n    }\n}\n","export function shutdown() {\n    return makePacket(0x01);\n}\nexport function setMeasurementInterval(interval) {\n    return makePacket(0x08, Buffer.of(0x00, interval));\n}\nexport function setTime(now = new Date()) {\n    const values = Buffer.alloc(4);\n    values.writeUInt32BE(Math.trunc(now.getTime() / 1000));\n    return makePacket(0x09, values);\n}\nexport function readHistory() {\n    return makePacket(0x0a);\n}\nexport function nextHistory() {\n    return makePacket(0x0b);\n}\nexport function setMeasurementEnable(enabled) {\n    return makePacket(0x16, Buffer.of(enabled ? 0x01 : 0x00));\n}\nfunction makePacket(type, values = Buffer.of()) {\n    const header = Buffer.of(0xaa, type);\n    const payload = Buffer.concat([header, values]);\n    const checksum = payload.reduce((prev, curr) => prev + curr, 0);\n    return Buffer.of(...payload, checksum);\n}\n","export const RX_SERVICE_UUID = '6e400001-b5a3-f393-e0a9-e50e24dcca9e';\nexport const RX_CHAR_UUID = '6e400002-b5a3-f393-e0a9-e50e24dcca9e';\nexport const TX_CHAR_UUID = '6e400003-b5a3-f393-e0a9-e50e24dcca9e';\n","export class ShutdownPacket {\n    constructor(data) {\n        assert(data, 0x01);\n    }\n    toString() {\n        return 'Shutdown';\n    }\n}\nexport class NoMoreHistoryPacket {\n    constructor(data) {\n        assert(data, 0x0a);\n    }\n    toString() {\n        return 'No More History';\n    }\n}\nexport class HistoryPacket {\n    constructor(data) {\n        assert(data, 0x0b);\n        this.pm25 = data.readUInt16BE(0x2);\n        this.recordDate = new Date(data.readUInt32BE(0x6) * 1000);\n    }\n    toString() {\n        return `PM 2.5: ${this.pm25}`;\n    }\n}\nexport class BatteryPacket {\n    constructor(data) {\n        assert(data, 0x50);\n        this.capacity = data.readUInt8(0x3);\n        this.isCharging = data.readUInt8(0x6) === 1;\n        Object.freeze(this);\n        Object.seal(this);\n    }\n    toString() {\n        if (this.isCharging) {\n            return 'Charging';\n        }\n        return `Battery: ${this.capacity}%`;\n    }\n}\nexport class RuntimePacket {\n    constructor(data) {\n        assert(data, 0x50);\n        this.runtime = data.readUInt32BE(0x3);\n        this.boottime = data.readUInt32BE(0x7);\n        Object.freeze(this);\n        Object.seal(this);\n    }\n    toString() {\n        return `Run time: ${this.runtime} sec, Boot time: ${this.boottime} sec`;\n    }\n}\nexport class SensorPacket {\n    constructor(data) {\n        assert(data, 0x50);\n        this.pm25 = data.readUInt16BE(0x3);\n        this.recordDate = new Date(data.readUInt32BE(0x7) * 1000);\n        this.currentDate = new Date(data.readUInt32BE(0xc) * 1000);\n        Object.freeze(this);\n        Object.seal(this);\n    }\n    toString() {\n        return `PM 2.5: ${this.pm25}`;\n    }\n}\nexport class MeasurementSetupPacket {\n    constructor(data) {\n        assert(data, 0x50);\n        this.interval = data.readUInt16BE(0x3);\n        this.enabled = data.readUInt8(0x5) !== 0;\n        Object.freeze(this);\n        Object.seal(this);\n    }\n    toString() {\n        if (!this.enabled) {\n            return 'Interval measurement disabled';\n        }\n        return `Internal: ${this.interval} minutes`;\n    }\n}\nexport class VersionPacket {\n    constructor(data) {\n        assert(data, 0x54);\n        this.minor = data.readUInt16BE(0x2);\n        this.major = data.readUInt16BE(0x4);\n        Object.freeze(this);\n        Object.seal(this);\n    }\n    toString() {\n        return `${this.major}.${this.minor}`;\n    }\n}\nfunction assert(data, type) {\n    if (data[0] !== 0xaa) {\n        throw new Error('unexpected header');\n    }\n    else if (data[1] !== type) {\n        throw new Error('unexpected type');\n    }\n}\nconst mapping = {\n    aa01: ShutdownPacket,\n    aa0a: NoMoreHistoryPacket,\n    aa0b: HistoryPacket,\n    aa5004: BatteryPacket,\n    aa5005: RuntimePacket,\n    aa5006: SensorPacket,\n    aa5007: MeasurementSetupPacket,\n    aa5400: VersionPacket,\n};\nexport function readPacket(block) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-expect-error\n    const Packet = mapping[block.slice(0, 3).toString('hex')] || mapping[block.slice(0, 2).toString('hex')];\n    return new Packet(block);\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"_3Q4jVp-XdRE9lL_y-DHvqZ\",\"table\":\"_12l9Lp-US87GiC9o0PbHWo\",\"field\":\"_1BDqlaGx2FzEtv1WMIea58\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"excellent\":\"_1MN1iQ__lDcfDATezKh6gq\",\"good\":\"_2iF4fs9zFDhmn9gwKtuKZy\",\"lightly-polluted\":\"IXUN-3jdHZPyDpVihuQSU\",\"moderately-polluted\":\"_2JxHIf0Kw8tOb67KCYrrmO\",\"heavily-polluted\":\"_2tXPdGxFj1gNC4vHrkw8sx\",\"severely-polluted\":\"_4X8048EGadeXADBH2Wpyh\"};","import actionCreatorFactory from 'typescript-fsa';\nimport { asyncFactory } from 'typescript-fsa-redux-thunk';\nimport { SensorService, HistoryPacket } from '../service';\nimport * as Commands from '../service/commands';\nconst create = actionCreatorFactory('SENSOR');\nconst createAsync = asyncFactory(create);\nexport const setConnected = create('SET_CONNECTED');\nexport const updatePacket = create('UPDATE_PACKET');\nexport const requestDevice = createAsync('REQUEST_DEVICE', async () => {\n    return SensorService.requestDevice();\n});\nexport const connect = createAsync('CONNECT', async (params, dispatch, getState) => {\n    const { sensor } = getState();\n    if (sensor === null) {\n        return;\n    }\n    await sensor.connect();\n    dispatch(setConnected(true));\n    sensor.on('disconnected', () => dispatch(setConnected(false)));\n    sensor.on('packet', async (packet) => {\n        if (packet instanceof HistoryPacket) {\n            await sensor.sendCommand(Commands.nextHistory());\n        }\n        return dispatch(updatePacket(packet));\n    });\n    sensor.on('failed', (packet) => {\n        console.log('Block', packet.toString('hex').toUpperCase());\n    });\n    await sensor.sendCommand(Commands.setTime());\n});\nexport const disconnect = createAsync('DISCONNECT', async (params, dispatch, getState) => {\n    const { sensor } = getState();\n    return sensor === null || sensor === void 0 ? void 0 : sensor.disconnect();\n});\nconst sendMessage = createAsync('SEND_MESSAGE', async (payload, dispatch, getState) => {\n    const { sensor } = getState();\n    return sensor === null || sensor === void 0 ? void 0 : sensor.sendCommand(payload);\n});\nexport const setMeasurementEnable = (enabled) => sendMessage(Commands.setMeasurementEnable(enabled));\nexport const setMeasurementInterval = (value) => sendMessage(Commands.setMeasurementInterval(value));\nexport const shutdown = () => sendMessage(Commands.shutdown());\nexport const readHistory = () => sendMessage(Commands.readHistory());\n","import { reducerWithInitialState } from 'typescript-fsa-reducers';\nimport { requestDevice } from '../actions/sensor';\n// prettier-ignore\nexport default reducerWithInitialState(null)\n    .case(requestDevice.async.done, (state, payload) => payload.result);\n","import { produce } from 'immer';\nimport { reducerWithInitialState } from 'typescript-fsa-reducers';\nimport { setConnected, updatePacket } from '../actions/sensor';\nimport _ from 'lodash-es';\nimport { BatteryPacket, HistoryPacket, MeasurementSetupPacket, NoMoreHistoryPacket, RuntimePacket, SensorPacket, ShutdownPacket, VersionPacket, } from '../service';\nconst defaultState = {\n    connected: false,\n    shuttingdown: false,\n    latest: {},\n    history: [],\n    historyFully: false,\n};\nexport default reducerWithInitialState(defaultState)\n    .case(setConnected, (state, connected) => produce(state, (draft) => {\n    if (!connected) {\n        draft.shuttingdown = false;\n        draft.latest = {};\n    }\n    draft.connected = connected;\n}))\n    .case(updatePacket, (state, packet) => produce(state, (draft) => {\n    draft.shuttingdown = false;\n    if (packet instanceof BatteryPacket) {\n        draft.latest.batteryCapacity = packet.capacity;\n        draft.latest.batteryCharging = packet.isCharging;\n    }\n    else if (packet instanceof MeasurementSetupPacket) {\n        draft.latest.measurementInterval = packet.interval;\n        draft.latest.measurementIntervalEnabled = packet.enabled;\n    }\n    else if (packet instanceof RuntimePacket) {\n        draft.latest.runTime = packet.runtime;\n        draft.latest.bootTime = packet.boottime;\n    }\n    else if (packet instanceof SensorPacket) {\n        draft.latest.pm25 = packet.pm25;\n        draft.latest.recordDate = packet.recordDate;\n    }\n    else if (packet instanceof VersionPacket) {\n        draft.latest.version = [packet.major, packet.minor].join('.');\n    }\n    else if (packet instanceof ShutdownPacket) {\n        draft.shuttingdown = true;\n    }\n    else if (packet instanceof HistoryPacket) {\n        draft.history.push({\n            pm25: packet.pm25,\n            recordDate: packet.recordDate,\n        });\n        draft.history = _.sortedUniqBy(draft.history, (record) => { var _a; return (_a = record.recordDate) === null || _a === void 0 ? void 0 : _a.getTime(); });\n    }\n    else if (packet instanceof NoMoreHistoryPacket) {\n        draft.historyFully = true;\n    }\n}));\n","var _a;\nimport { createStore, compose, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport { createMemoryHistory } from 'history';\nimport { routerMiddleware } from 'connected-react-router';\nimport { createRootReducer } from './reducers';\nexport const history = createMemoryHistory();\n// prettier-ignore\nconst composeEnhancers = process.env.NODE_ENV === 'production'\n    ? compose\n    : (_a = Reflect.get(window, '__REDUX_DEVTOOLS_EXTENSION_COMPOSE__')) !== null && _a !== void 0 ? _a : compose;\nexport const configureStore = () => createStore(createRootReducer(history), undefined, composeEnhancers(applyMiddleware(routerMiddleware(history), // connected-react-router\nthunk)));\n","import React from 'react';\nimport locals from './FormattedPM25.scss';\nexport const FormattedPM25 = ({ value }) => {\n    if (value === undefined) {\n        return React.createElement(\"span\", null, \"N/A\");\n    }\n    const level = getLevel(value);\n    return (React.createElement(\"span\", null,\n        React.createElement(\"span\", null,\n            value,\n            \" \\u03BCg/m\",\n            React.createElement(\"sup\", null, \"3\")),\n        React.createElement(\"span\", { className: locals[level] },\n            \" (\",\n            level.replace(/-/g, ' '),\n            \")\")));\n};\nvar Level;\n(function (Level) {\n    Level[\"Excellent\"] = \"excellent\";\n    Level[\"Good\"] = \"good\";\n    Level[\"LightlyPolluted\"] = \"lightly-polluted\";\n    Level[\"ModeratelyPolluted\"] = \"moderately-polluted\";\n    Level[\"HeavilyPolluted\"] = \"heavily-polluted\";\n    Level[\"SeverelyPolluted\"] = \"severely-polluted\";\n})(Level || (Level = {}));\nconst getLevel = (value) => {\n    if (value <= 35) {\n        return Level.Excellent;\n    }\n    else if (value <= 75) {\n        return Level.Good;\n    }\n    else if (value <= 115) {\n        return Level.LightlyPolluted;\n    }\n    else if (value <= 150) {\n        return Level.ModeratelyPolluted;\n    }\n    else if (value <= 250) {\n        return Level.HeavilyPolluted;\n    }\n    else {\n        return Level.SeverelyPolluted;\n    }\n};\n","import React from 'react';\nimport { Row, Table, Button } from 'reactstrap';\nimport { useSelector } from 'react-redux';\nexport const History = () => {\n    const history = useSelector((state) => state.report.history);\n    const onDownload = () => {\n        const encoded = JSON.stringify(history, null, 2);\n        const link = document.createElement('a');\n        link.href = URL.createObjectURL(new Blob([encoded], { type: 'application/json' }));\n        link.download = makeDownloadFile();\n        link.click();\n    };\n    return (React.createElement(Row, { hidden: history.length === 0 },\n        React.createElement(\"h1\", null,\n            \"History\",\n            ' ',\n            React.createElement(Button, { size: 'sm', color: 'link', onClick: onDownload }, \"Download\")),\n        React.createElement(Table, { responsive: true, borderless: true, size: 'sm' },\n            React.createElement(\"thead\", null,\n                React.createElement(\"tr\", null,\n                    React.createElement(\"th\", null, \"#\"),\n                    React.createElement(\"th\", null,\n                        \"PM \",\n                        React.createElement(\"sub\", null, \"2.5\")))),\n            React.createElement(\"tbody\", null, history.map(({ recordDate, pm25 }, index) => (React.createElement(\"tr\", { key: index },\n                React.createElement(\"td\", null, recordDate === null || recordDate === void 0 ? void 0 : recordDate.toLocaleString()),\n                React.createElement(\"td\", null, pm25))))))));\n};\nfunction makeDownloadFile() {\n    const now = new Date();\n    const fields = [now.getFullYear(), now.getMonth() + 1, now.getDate(), now.getHours(), now.getMinutes(), now.getSeconds()];\n    const timestamp = fields.map((value) => value.toString().padStart(2, '0')).join('');\n    return `history-${timestamp}.json`;\n}\n","import React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Button, Modal, ModalBody, ModalFooter, ModalHeader, ListGroup, ListGroupItem } from 'reactstrap';\nimport { setMeasurementEnable, setMeasurementInterval } from '../../actions/sensor';\nconst steps = [5, 10, 15, 30, 60, 90, 120];\nexport const MeasurementInterval = () => {\n    const target = React.useRef(null);\n    const [open, setOpen] = React.useState(false);\n    const dispatch = useDispatch();\n    const connected = useSelector((state) => state.report.connected);\n    const interval = useSelector((state) => state.report.latest.measurementInterval);\n    const enabled = useSelector((state) => state.report.latest.measurementIntervalEnabled);\n    const onToggle = () => setOpen(connected && !open);\n    const onChange = async (value) => {\n        setOpen(false);\n        await dispatch(setMeasurementInterval(value));\n        await dispatch(setMeasurementEnable(true));\n    };\n    const onDisable = async () => {\n        setOpen(false);\n        dispatch(setMeasurementEnable(false));\n    };\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"span\", { onClick: onToggle }, enabled ? `${interval} minutes` : 'Disabled'),\n        React.createElement(Modal, { placement: 'bottom', isOpen: open, target: target, toggle: onToggle },\n            React.createElement(ModalHeader, null, \"Measurement interval\"),\n            React.createElement(ModalBody, null,\n                React.createElement(\"p\", null,\n                    \"Current Interval: \",\n                    interval,\n                    \" minutes\"),\n                React.createElement(ListGroup, null, steps.map((step) => (React.createElement(ListGroupItem, { onClick: () => onChange(step), key: step, active: step === interval },\n                    step,\n                    \" minutes\"))))),\n            React.createElement(ModalFooter, null,\n                React.createElement(Button, { color: 'primary', onClick: onDisable, hidden: !enabled }, \"Disable\"),\n                React.createElement(Button, { color: 'secondary', onClick: onToggle }, \"Cancel\")))));\n};\n","import prettyDuration from 'pretty-ms';\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Button, ButtonGroup, Container, Progress, Row, Table } from 'reactstrap';\nimport { connect, disconnect, readHistory, requestDevice, shutdown } from '../../actions/sensor';\nimport { FormattedPM25 } from './FormattedPM25';\nimport { History } from './History';\nimport locals from './index.scss';\nimport { MeasurementInterval } from './MeasurementInterval';\nexport const SensorConsole = () => {\n    var _a, _b, _c, _d;\n    const dispatch = useDispatch();\n    const connected = useSelector((state) => state.report.connected);\n    const shuttingdown = useSelector((state) => state.report.shuttingdown);\n    const latest = useSelector((state) => state.report.latest);\n    const onConnect = async () => {\n        if (connected) {\n            await dispatch(disconnect());\n        }\n        else {\n            await dispatch(requestDevice());\n            await dispatch(connect());\n        }\n    };\n    const onShutdown = () => dispatch(shutdown());\n    const onReadHistory = () => dispatch(readHistory());\n    return (React.createElement(Container, { className: locals.container },\n        React.createElement(Row, null,\n            React.createElement(ButtonGroup, null,\n                React.createElement(Button, { color: connected ? 'success' : 'primary', onClick: onConnect }, connected ? 'Disconnect' : 'Connect'),\n                React.createElement(Button, { disabled: !connected, color: connected ? 'danger' : undefined, onClick: onShutdown }, shuttingdown ? 'Shutting down' : 'Shutdown'),\n                React.createElement(Button, { disabled: !(connected && latest.measurementIntervalEnabled), color: connected ? 'info' : undefined, onClick: onReadHistory }, \"Read history (one-time)\"))),\n        React.createElement(Row, null,\n            React.createElement(\"h1\", null, \"Real-time\"),\n            React.createElement(Table, { className: locals.table, responsive: true, borderless: true },\n                React.createElement(\"thead\", null,\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"th\", { className: locals.field }, \"#\"),\n                        React.createElement(\"th\", null, \"Value\"))),\n                React.createElement(\"tbody\", null,\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"td\", null,\n                            \"PM \",\n                            React.createElement(\"sub\", null, \"2.5\")),\n                        React.createElement(\"td\", { className: 'text-monospace' },\n                            React.createElement(FormattedPM25, { value: latest.pm25 }))),\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"td\", null, \"Battery\"),\n                        React.createElement(\"td\", null,\n                            React.createElement(Progress, { value: (_a = latest.batteryCapacity) !== null && _a !== void 0 ? _a : 0 },\n                                latest.batteryCapacity ? `${latest.batteryCapacity}%` : 'N/A',\n                                \" \",\n                                latest.batteryCharging ? '(Charging)' : '(Discharge)'))),\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"td\", null, \"Record date\"),\n                        React.createElement(\"td\", { className: 'text-monospace' }, (_c = (_b = latest.recordDate) === null || _b === void 0 ? void 0 : _b.toLocaleString()) !== null && _c !== void 0 ? _c : 'N/A')),\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"td\", null, \"Runtime\"),\n                        React.createElement(\"td\", { className: 'text-monospace' }, latest.runTime ? prettyDuration(latest.runTime * 1000) : 'N/A')),\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"td\", null, \"Boot time\"),\n                        React.createElement(\"td\", { className: 'text-monospace' }, latest.bootTime ? prettyDuration(latest.bootTime * 1000) : 'N/A')),\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"td\", null, \"Measurement Interval\"),\n                        React.createElement(\"td\", { className: 'text-monospace' },\n                            React.createElement(MeasurementInterval, null))),\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"td\", null, \"Firmare Version\"),\n                        React.createElement(\"td\", { className: 'text-monospace' }, (_d = latest.version) !== null && _d !== void 0 ? _d : 'N/A'))))),\n        React.createElement(History, null)));\n};\n","import React from 'react';\nimport { Provider } from 'react-redux';\nimport { Route, Switch } from 'react-router';\nimport { ConnectedRouter } from 'connected-react-router';\nimport { configureStore, history } from './configureStore';\nimport { SensorConsole } from './components/SensorConsole';\nconst store = configureStore();\nexport const Entry = () => (React.createElement(Provider, { store: store },\n    React.createElement(ConnectedRouter, { history: history },\n        React.createElement(Switch, null,\n            React.createElement(Route, { exact: true, path: '/', component: SensorConsole })))));\n","import { combineReducers } from 'redux';\nimport { connectRouter } from 'connected-react-router';\nimport sensor from './sensor';\nimport report from './report';\nexport const createRootReducer = (history) => combineReducers({\n    router: connectRouter(history),\n    sensor,\n    report,\n});\n","import 'bootstrap/dist/css/bootstrap.min.css';\nimport ready from 'domready';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Entry } from './Entry';\nready(() => {\n    const container = document.createElement('main');\n    document.body = document.createElement('body');\n    document.body.appendChild(container);\n    ReactDOM.render(React.createElement(Entry), container);\n});\n"],"sourceRoot":""}